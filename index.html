<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="theme-color" content="#F2F2F7">
  <title>Study Spark | Ultimate Workspace</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- External Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

  <!-- Modular CSS -->
  <link rel="stylesheet" href="src/styles/base.css">
  <link rel="stylesheet" href="src/styles/layout.css">
  <link rel="stylesheet" href="src/styles/sidebar.css">
  <link rel="stylesheet" href="src/styles/components.css">
</head>

<body>


  <div id="loader"
    style="position:fixed; inset:0; background:var(--bg-body); z-index:999; display:flex; flex-direction:column; align-items:center; justify-content:center;">
    <div class="animate-spin"
      style="width:50px; height:50px; border:4px solid var(--bg-input); border-top-color:var(--accent-blue); border-radius:50%;">
    </div>
    <h3 style="margin-top:20px; font-weight:600;">Igniting Spark...</h3>
  </div>

  <div id="toast">
    <span id="toastMsg">Action Completed</span>
    <button id="toastUndo"
      style="background:rgba(255,255,255,0.2); border:none; color:white; padding:4px 8px; border-radius:4px; cursor:pointer; font-size:0.8rem;">UNDO</button>
  </div>

  <div class="sidebar-overlay" id="sidebarOverlay"></div>

  <div class="app-layout" id="appLayout">

    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div style="display:flex; align-items:center; gap:12px;">
          <h2 class="text-h2">Tasks</h2>
          <button type="button" class="btn-random" id="btnRandomTask" title="Pick Random Task">
            Pick Random
          </button>
        </div>
        <button class="btn-ghost" id="sidebarClose">âœ•</button>
      </div>

      <div class="task-input-container">
        <form id="addTaskForm">
          <input type="text" id="taskInput" class="task-main-input" placeholder="What needs focusing?"
            autocomplete="off">

          <div class="task-meta-row">
            <div class="days-input-wrapper">
              <span class="text-xs" style="color:var(--text-tertiary)">DUE IN</span>
              <input type="text" id="taskDays" class="days-input" placeholder="Due">
              <span class="text-xs" style="color:var(--text-tertiary)">DAYS</span>
            </div>
            <button type="submit" class="btn-primary" style="padding: 8px 16px; font-size:0.85rem;">Add</button>
          </div>

          <div class="color-picker">
            <div class="color-dot active" style="background: var(--accent-blue);" data-color="blue"></div>
            <div class="color-dot" style="background: var(--accent-purple);" data-color="purple"></div>
            <div class="color-dot" style="background: var(--accent-green);" data-color="green"></div>
            <div class="color-dot" style="background: var(--accent-orange);" data-color="orange"></div>
            <div class="color-dot" style="background: var(--accent-red);" data-color="red"></div>
          </div>
        </form>
      </div>

      <div class="task-list-wrapper" id="taskScroll">
        <div id="taskList"></div>

        <div id="emptyState" class="hidden" style="text-align:center; padding:40px 0; opacity:0.5;">
          <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1"
            style="margin-bottom:16px;">
            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
          </svg>
          <p>All caught up!</p>
        </div>

        <div class="completed-section" id="completedSection">
          <div class="completed-header">
            <div class="completed-header-left" onclick="toggleCompleted()">
              <span class="text-xs">COMPLETED HISTORY</span>
              <span id="completedArrow">â–¼</span>
            </div>
            <button type="button" class="btn-clear-history" onclick="event.stopPropagation(); clearCompletedHistory();" title="Clear all completed tasks">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
              </svg>
              Clear
            </button>
          </div>
          <div id="completedList"></div>
        </div>
      </div>
    </aside>

    <main class="main-content">
      <header class="top-bar">
        <div style="display:flex; align-items:center;">
          <button type="button" class="toggle-sidebar-btn" id="sidebarToggle">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="9" y1="3" x2="9" y2="21"></line>
            </svg>
          </button>
          <div>
            <p class="text-xs" style="color:var(--text-tertiary); margin-bottom:4px;" id="currentDate">FRIDAY, OCTOBER
              24</p>
            <h1 class="text-h1" id="greeting">Good Morning</h1>
          </div>
        </div>

        <div style="display: flex; gap: 12px; align-items: center;">
          <!-- Theme Selector -->
          <div class="theme-selector-container">
            <button type="button" class="btn-ghost theme-selector-btn" id="themeSelectorBtn"
              style="padding: 10px; border-radius: 50%; width: 42px; height: 42px;">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path>
              </svg>
            </button>
            <div class="theme-dropdown" id="themeDropdown">
              <div class="theme-dropdown-header">Select Theme</div>
              <button class="theme-option" data-theme="cappuccino">
                <div class="theme-color-preview" style="background: linear-gradient(135deg, #FAFAFA 50%, #5B7C99 50%);"></div>
                <span>Cappuccino (Light)</span>
              </button>
              <button class="theme-option" data-theme="catppuccin">
                <div class="theme-color-preview" style="background: linear-gradient(135deg, #1e1e2e 50%, #89b4fa 50%);"></div>
                <span>Catppuccin (Dark)</span>
              </button>
              <button class="theme-option" data-theme="nord">
                <div class="theme-color-preview" style="background: linear-gradient(135deg, #2e3440 50%, #88c0d0 50%);"></div>
                <span>Nord</span>
              </button>
              <button class="theme-option" data-theme="dracula">
                <div class="theme-color-preview" style="background: linear-gradient(135deg, #282a36 50%, #8be9fd 50%);"></div>
                <span>Dracula</span>
              </button>
              <button class="theme-option" data-theme="gruvbox">
                <div class="theme-color-preview" style="background: linear-gradient(135deg, #282828 50%, #b8bb26 50%);"></div>
                <span>Gruvbox</span>
              </button>
              <button class="theme-option" data-theme="solarized-dark">
                <div class="theme-color-preview" style="background: linear-gradient(135deg, #002b36 50%, #268bd2 50%);"></div>
                <span>Solarized Dark</span>
              </button>
              <button class="theme-option" data-theme="solarized-light">
                <div class="theme-color-preview" style="background: linear-gradient(135deg, #fdf6e3 50%, #268bd2 50%);"></div>
                <span>Solarized Light</span>
              </button>
              <button class="theme-option" data-theme="monokai">
                <div class="theme-color-preview" style="background: linear-gradient(135deg, #272822 50%, #a6e22e 50%);"></div>
                <span>Monokai</span>
              </button>
              <button class="theme-option" data-theme="onedark">
                <div class="theme-color-preview" style="background: linear-gradient(135deg, #282c34 50%, #61afef 50%);"></div>
                <span>One Dark</span>
              </button>
              <button class="theme-option" data-theme="tokyonight">
                <div class="theme-color-preview" style="background: linear-gradient(135deg, #1a1b26 50%, #7aa2f7 50%);"></div>
                <span>Tokyo Night</span>
              </button>
              <div class="theme-divider"></div>
              <div id="customThemesList"></div>
              <button class="theme-option" id="customThemeBtn">
                <div class="theme-color-preview" style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #f7b731);"></div>
                <span>âœ¨ Create Custom Theme</span>
              </button>
            </div>
          </div>
          <button type="button" class="auth-btn" id="loginBtn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4" />
              <polyline points="10 17 15 12 10 7" />
              <line x1="15" y1="12" x2="3" y2="12" />
            </svg>
            Sign In
          </button>
        </div>
      </header>

      <section class="focus-hero" id="focusHero">
      </section>

      <div class="bento-grid">
        <div class="bento-card">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <span class="text-xs" style="color:var(--text-tertiary)">POMODORO TIMER</span>
            <button type="button" class="btn-icon-circle" onclick="toggleModal('timerModal')">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"></circle>
                <path
                  d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                </path>
              </svg>
            </button>
          </div>

          <div class="timer-presets" style="margin-top: 10px; display:flex; gap:8px; justify-content:center;">
            <button type="button" class="btn-ghost" onclick="setTimer(25)"
              style="font-size:0.8rem; padding:4px 10px; border:1px solid var(--border-color);">Focus 25</button>
            <button type="button" class="btn-ghost" onclick="setTimer(5)"
              style="font-size:0.8rem; padding:4px 10px; border:1px solid var(--border-color);">Short 5</button>
            <button type="button" class="btn-ghost" onclick="setTimer(15)"
              style="font-size:0.8rem; padding:4px 10px; border:1px solid var(--border-color);">Long 15</button>
          </div>

          <div style="flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center;">
            <div class="timer-display" id="timerDisplay">25:00</div>
            <div class="timer-controls">
              <button type="button" id="startTimerBtn" class="btn-primary">Start Focus</button>
              <button type="button" id="resetTimerBtn" class="btn-ghost">Reset</button>
            </div>
          </div>
        </div>

        <div class="bento-card">
          <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 12px;">
            <span class="text-xs" style="color:var(--text-tertiary)">DAILY GOAL</span>
            <div style="display:flex; align-items:center; gap:8px;" role="status" aria-label="Streak indicator">
              <span class="text-xs" style="color:var(--text-tertiary)" aria-hidden="true">ðŸ”¥</span>
              <span class="text-body" id="streakCount" style="font-weight:600; color:var(--accent-orange);">0</span>
              <span class="text-xs" style="color:var(--text-tertiary)">DAY STREAK</span>
            </div>
          </div>
          <div style="flex:1; display:flex; flex-direction:column; justify-content:center; gap:16px;">
            <div style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
              <div style="flex:1;">
                <div style="display:flex; align-items:baseline; gap:8px; margin-bottom:8px;">
                  <span class="text-h1" id="progressPercent">0%</span>
                  <span class="text-body" id="progressText">0/0 Tasks</span>
                </div>
                <div style="display:flex; align-items:center; gap:8px;">
                  <span class="text-sm" style="color:var(--text-secondary);">Goal:</span>
                  <div id="dailyGoalDisplay" onclick="openDailyGoalModal()" role="button" tabindex="0" aria-label="Edit daily goal"
                    onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();openDailyGoalModal();}"
                    style="padding:4px 12px; border-radius:6px; background:var(--bg-input); color:var(--text-primary); font-size:0.9rem; cursor:pointer; transition:all 0.2s; border:1px solid transparent;"
                    onmouseover="this.style.borderColor='var(--accent-blue)'; this.style.background='var(--accent-blue-soft)'"
                    onmouseout="this.style.borderColor='transparent'; this.style.background='var(--bg-input)'"
                    onfocus="this.style.borderColor='var(--accent-blue)'; this.style.background='var(--accent-blue-soft)'"
                    onblur="this.style.borderColor='transparent'; this.style.background='var(--bg-input)'">
                    <span id="dailyGoalValue">5</span> tasks/day
                  </div>
                </div>
              </div>
            </div>
            <div style="width:100%; height:10px; background:var(--bg-input); border-radius:10px; overflow:hidden; position:relative;">
              <div id="progressBar"
                style="width:0%; height:100%; background:linear-gradient(90deg, var(--accent-green), var(--accent-blue)); transition: width 0.8s var(--ease-spring); box-shadow: 0 0 10px rgba(6, 214, 160, 0.3);">
              </div>
            </div>
            <p class="text-sm" style="color:var(--text-secondary);" id="progressQuote">Set your daily goal and build your streak! ðŸš€</p>
          </div>
        </div>
      </div>

      <section>
        <div class="courses-header">
          <div>
            <h2 class="text-h2">Courses & Projects</h2>
            <p class="text-body">Manage lectures, labs, and deadlines.</p>
          </div>
          <button type="button" class="btn-new-course" onclick="addCourse()">+ New Course</button>
        </div>

        <div class="courses-grid" id="coursesContainer"></div>

        <div id="emptyCourses" class="hidden"
          style="text-align:center; padding: 60px; color:var(--text-tertiary); border:2px dashed var(--bg-input); border-radius:var(--radius-lg);">
          <p class="text-h3" style="margin-bottom:8px;">No courses yet</p>
          <p>Click "New Course" to start organizing your studies.</p>
        </div>
      </section>
    </main>
  </div>

  <div class="course-modal-overlay" id="courseModal">
    <div class="course-modal">
      <div class="course-modal-header">
        <input type="text" class="course-modal-title-input" id="modalCourseTitle" placeholder="Course Name">
        <button type="button" class="course-modal-close" onclick="closeCourseModal()">âœ•</button>
      </div>
      <div class="course-modal-body" id="courseModalBody">
      </div>
      <div class="course-modal-footer">
        <div class="course-colors" id="modalCourseColors">
        </div>
        <button type="button" class="btn-danger" id="modalDeleteBtn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            <line x1="10" y1="11" x2="10" y2="17"></line>
            <line x1="14" y1="11" x2="14" y2="17"></line>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="timerModal">
    <div class="modal">
      <h3 class="text-h3" style="margin-bottom:24px;">Timer Settings</h3>
      <div style="margin-bottom:20px;">
        <label class="text-xs" style="color:var(--text-secondary); display:block; margin-bottom:8px;">FOCUS DURATION
          (MIN)</label>
        <input type="number" id="customWorkDur" value="25"
          style="width:100%; padding:12px; border-radius:8px; border:1px solid var(--bg-input); background:var(--bg-body); color:var(--text-primary); font-size:1.1rem;">
      </div>
      <div style="display:flex; justify-content:flex-end; gap:12px;">
        <button type="button" class="btn-ghost" onclick="toggleModal('timerModal')">Cancel</button>
        <button type="button" class="btn-primary" onclick="saveTimerSettings()">Save</button>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="dailyGoalModal">
    <div class="modal">
      <h3 class="text-h3" style="margin-bottom:24px;">Edit Daily Goal</h3>
      <div style="margin-bottom:20px;">
        <label class="text-xs" style="color:var(--text-secondary); display:block; margin-bottom:8px;">DAILY TASK GOAL</label>
        <input type="number" id="modalDailyGoalInput" min="1" max="50" value="5" aria-label="Daily task goal"
          style="width:100%; padding:12px; border-radius:8px; border:1px solid var(--bg-input); background:var(--bg-body); color:var(--text-primary); font-size:1.1rem;">
        <p class="text-sm" style="color:var(--text-secondary); margin-top:8px;">Set how many tasks you want to complete each day</p>
      </div>
      <div style="display:flex; justify-content:flex-end; gap:12px;">
        <button type="button" class="btn-ghost" onclick="toggleModal('dailyGoalModal')">Cancel</button>
        <button type="button" class="btn-primary" onclick="saveDailyGoal()">Save</button>
      </div>
    </div>
  </div>

  <!-- Custom Theme Creator Modal -->
  <div class="modal-overlay" id="customThemeModal">
    <div class="custom-theme-modal">
      <div class="custom-theme-header">
        <h3 class="custom-theme-title">Create Custom Theme</h3>
        <button type="button" class="course-modal-close" onclick="closeCustomThemeModal()">âœ•</button>
      </div>
      <div class="custom-theme-body">
        <div class="color-picker-group">
          <label class="color-picker-label">Theme Name</label>
          <input type="text" id="customThemeName" class="course-modal-title-input" placeholder="My Awesome Theme" style="width: 100%; margin-bottom: 16px;">
        </div>
        
        <div class="preview-box">
          <div class="preview-text preview-primary">Preview: Primary Text</div>
          <div class="preview-text preview-secondary">Preview: Secondary Text</div>
          <span class="preview-accent">Accent Preview</span>
        </div>
        
        <div class="color-picker-group">
          <label class="color-picker-label">Background Colors</label>
          <div class="color-picker-row">
            <input type="color" id="customBgBody" class="color-picker-input" value="#FAFAFA">
            <input type="text" id="customBgBodyHex" class="color-picker-hex" value="#FAFAFA" placeholder="Body Background">
          </div>
          <div class="color-picker-row">
            <input type="color" id="customBgCard" class="color-picker-input" value="#FFFFFF">
            <input type="text" id="customBgCardHex" class="color-picker-hex" value="#FFFFFF" placeholder="Card Background">
          </div>
          <div class="color-picker-row">
            <input type="color" id="customBgInput" class="color-picker-input" value="#F5F5F5">
            <input type="text" id="customBgInputHex" class="color-picker-hex" value="#F5F5F5" placeholder="Input Background">
          </div>
        </div>

        <div class="color-picker-group">
          <label class="color-picker-label">Text Colors</label>
          <div class="color-picker-row">
            <input type="color" id="customTextPrimary" class="color-picker-input" value="#111111">
            <input type="text" id="customTextPrimaryHex" class="color-picker-hex" value="#111111" placeholder="Primary Text">
          </div>
          <div class="color-picker-row">
            <input type="color" id="customTextSecondary" class="color-picker-input" value="#666666">
            <input type="text" id="customTextSecondaryHex" class="color-picker-hex" value="#666666" placeholder="Secondary Text">
          </div>
        </div>

        <div class="color-picker-group">
          <label class="color-picker-label">Accent Colors</label>
          <div class="color-picker-row">
            <input type="color" id="customAccentBlue" class="color-picker-input" value="#5B7C99">
            <input type="text" id="customAccentBlueHex" class="color-picker-hex" value="#5B7C99" placeholder="Blue Accent">
          </div>
          <div class="color-picker-row">
            <input type="color" id="customAccentGreen" class="color-picker-input" value="#7A9B7E">
            <input type="text" id="customAccentGreenHex" class="color-picker-hex" value="#7A9B7E" placeholder="Green Accent">
          </div>
          <div class="color-picker-row">
            <input type="color" id="customAccentOrange" class="color-picker-input" value="#B89968">
            <input type="text" id="customAccentOrangeHex" class="color-picker-hex" value="#B89968" placeholder="Orange Accent">
          </div>
          <div class="color-picker-row">
            <input type="color" id="customAccentRed" class="color-picker-input" value="#B87E7E">
            <input type="text" id="customAccentRedHex" class="color-picker-hex" value="#B87E7E" placeholder="Red Accent">
          </div>
        </div>
      </div>
      <div class="custom-theme-footer">
        <button type="button" class="btn-ghost" onclick="closeCustomThemeModal()">Cancel</button>
        <button type="button" class="btn-primary" id="applyCustomThemeBtn">Apply Theme</button>
      </div>
    </div>
  </div>

  <!-- PDF Viewer Modal -->
  <div class="pdf-viewer-overlay" id="pdfViewerOverlay">
    <div class="pdf-viewer-container">
      <div class="pdf-viewer-header">
        <span class="pdf-viewer-title" id="pdfViewerTitle">Document.pdf</span>
        <div class="pdf-viewer-controls">
          <div class="pdf-page-controls">
            <button type="button" class="pdf-viewer-btn" id="pdfPrevPage" title="Previous">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"></polyline></svg>
            </button>
            <input type="number" class="pdf-page-input" id="pdfPageInput" value="1" min="1">
            <span class="pdf-page-total">/ <span id="pdfTotalPages">1</span></span>
            <button type="button" class="pdf-viewer-btn" id="pdfNextPage" title="Next">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
            </button>
          </div>
          <div class="pdf-controls-divider"></div>
          <div class="pdf-zoom-controls">
            <button type="button" class="pdf-viewer-btn" id="pdfZoomOut" title="Zoom Out">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            </button>
            <span class="pdf-zoom-level" id="pdfZoomLevel">100%</span>
            <button type="button" class="pdf-viewer-btn" id="pdfZoomIn" title="Zoom In">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            </button>
            <button type="button" class="pdf-viewer-btn" id="pdfFitWidth" title="Fit to Width">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 3H3v18h18V3zM9 21V3M15 21V3"></path></svg>
            </button>
          </div>
          <div class="pdf-controls-divider"></div>
          <button type="button" class="pdf-viewer-btn delete-btn" id="pdfRemoveAttachment" title="Remove PDF">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
          </button>
          <button type="button" class="pdf-viewer-btn close-btn" id="pdfCloseBtn" title="Close">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
          </button>
        </div>
      </div>
      <div class="pdf-viewer-body" id="pdfViewerBody">
        <div class="pdf-loading" id="pdfLoading">
          <div class="spinner"></div>
          <span>Loading PDF...</span>
        </div>
        <div class="pdf-canvas-wrapper" id="pdfCanvasWrapper"></div>
        <div class="pdf-error" id="pdfError" style="display: none;">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
          <span id="pdfErrorMsg">Failed to load PDF</span>
        </div>
        <!-- Minimal floating annotation tools button -->
        <div class="external-tools-panel" id="externalToolsPanel">
          <button type="button" class="external-tools-toggle" id="externalToolsToggle" aria-label="Open annotation tools">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path></svg>
            Annotate
          </button>
          <div class="external-tools-dropdown">
            <div class="external-tools-title">Open with</div>
            <a href="https://www.xodo.com/app/#/" target="_blank" rel="noopener noreferrer" class="external-tool-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-blue)" stroke-width="2" aria-hidden="true"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
              Xodo
            </a>
            <a href="https://www.adobe.com/acrobat/online/pdf-editor.html" target="_blank" rel="noopener noreferrer" class="external-tool-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="var(--accent-red)" stroke="none" aria-hidden="true"><path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3Z"/></svg>
              Adobe
            </a>
            <a href="https://smallpdf.com/edit-pdf" target="_blank" rel="noopener noreferrer" class="external-tool-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-green)" stroke-width="2" aria-hidden="true"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
              Smallpdf
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Hidden file input for PDF uploads -->
  <input type="file" id="pdfFileInput" class="hidden-file-input" accept=".pdf,application/pdf">


  <!-- Main Application Script -->
  <script type="module" src="src/app.js"></script>
</body>

</html>
